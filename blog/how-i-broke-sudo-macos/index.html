<!doctype html><html lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="text/html; charset=UTF-8" http-equiv=content-type><meta content="width=device-width,initial-scale=1,user-scalable=no" name=viewport><meta content="index, follow" name=robots><meta content=@confusedalex@indieweb.social name=fediverse:creator><link href=https://indieauth.com/auth rel=authorization_endpoint><link href=https://tokens.indieauth.com/token rel=token_endpoint><link href=https://webmention.io/confusedalex.dev/webmention rel=webmention><link href=https://webmention.io/confusedalex.dev/xmlrpc rel=pingback><title>How I broke sudo on my Dads Mac and how I fixed it</title><meta content="How I broke sudo on my Dads Mac and how I fixed it" name=title><meta content=confusedalex name=author><meta content=website property=og:type><meta content=https://confusedalex.dev/blog/how-i-broke-sudo-macos/ property=og:url><meta content=confusedalex property=og:site_name><meta content="How I broke sudo on my Dads Mac and how I fixed it" property=og:title><meta content=https://confusedalex.dev/icon.png property=og:image><meta content=summary_large_image property=twitter:card><meta content=https://confusedalex.dev/blog/how-i-broke-sudo-macos/ property=twitter:url><meta content="How I broke sudo on my Dads Mac and how I fixed it" property=twitter:title><meta content=https://confusedalex.dev/icon.png property=twitter:image><link href=https://confusedalex.dev/blog/how-i-broke-sudo-macos/ rel=canonical><link rel="shortcut icon" href=https://confusedalex.dev/favicon.ico type=image/x-icon><link href="https://confusedalex.dev/ atom.xml" rel=alternate title=RSS type=application/atom+xml><link href=/css/reset.css rel=stylesheet><link href=/css/suCSS.css rel=stylesheet><link href=https://confusedalex.dev/css/style.css rel=stylesheet><script defer src=https://confusedalex.dev/js/script.js></script><script data-website-id=7282c6fc-1b4a-4c34-80a0-af8d70c64587 defer src=https://stats.confusedalex.dev/script.js></script><body><header><nav id=nav-bar><a href=/> /home/ </a><a href=/blog> /blog/ </a><a href=/atom.xml> /rss/ </a></nav></header><main><article class=h-entry><div><a href=..>..</a>/<span class=accent-data><a class=u-url href=https://confusedalex.dev/blog/how-i-broke-sudo-macos/>how-i-broke-sudo-macos</a></span></div><time class=dt-published datetime=2024-01-19>Published on: <span class=accent-data>2024-01-19</span></time><address rel=author>By <span class=accent-data><a class="p-author h-card" href=https://confusedalex.dev>confusedalex</a></span></address><h1 class=p-name>How I broke sudo on my Dads Mac and how I fixed it</h1><div class=e-content><p>Currently, I’m in the process of migrating my Steam Deck to NixOS. Today finally arrived my 1 TB NVMe, so I rushed to installing it and reinstalling NixOS as I already had a working configuration. The annoying part is, that, when using <a href=https://github.com/Jovian-Experiments/Jovian-NixOS rel=noopener target=_blank>Jovian-NixOS</a> you need to compile the kernel. As this takes long and my father owns a M1 Mac, I thought about building my NixOS configuration on the mac and copying it to the Steam Deck.<h2 id=the-problem>The Problem</h2><p>I then installed Nix on the Mac and got everything working, but as I wanted to build my NixOS Configuration on the Mac, the build failed. It failed, because I couldn’t enter the sudo password. After much browsing the web, I wanted to make sudo passwordless. So I open <code>visudo</code> and changed<pre class=language-bash data-lang=bash style=color:#fdf4c1aa;background-color:#282828><code class=language-bash data-lang=bash><span style=color:#fdf4c1>%admin ALL=(ALL</span><span>) </span><span style=color:#fdf4c1>ALL
</span></code></pre><p>to<pre class=language-bash data-lang=bash style=color:#fdf4c1aa;background-color:#282828><code class=language-bash data-lang=bash><span style=color:#fdf4c1>%admin ALL=(ALL</span><span>) </span><span style=color:#fdf4c1>:NOPASSWD ALL
</span></code></pre><p>Do you see the mistake? It’s the wrong place column. But I was in a rush, saved the file, wanted to test out my new fancy passwordless sudo by running <code>sudo echo test</code> and got greeted by a <code>alex is not in suderos file</code>.<h2 id=the-journey-begins>The Journey begins</h2><h3 id=try-1>Try 1</h3><p>I tried out the <a href=https://superuser.com/a/1368278 rel=noopener target=_blank>here</a> described “Finder” solution but failed. I just couldn’t change the permission back. An hour later, I moved on to recovery mode.<h3 id=try-2-recovery-mode-my-savior>Try 2 — Recovery Mode, my savior</h3><p>So, I finally booted into recovery mode, and logged in. Then mounted the Data disk via the disk utility program.<br> Now I could open a terminal, navigate to <code>/foo/bar/etc</code> and repair the file permission while also fixing the typo.<h2 id=what-i-ve-learned>What I’ve learned</h2><ol><li>If visudo asks you if you really want to save the File, don’t blindly type yes!<li>root is your friend</ol><p>I would love to hear about your funny tech fails. Just send me an email.</div><p class=tags-data><a href=/tags/mac>/mac/</a> <a href=/tags/linux>/linux/</a> <a href=/tags/tech>/tech/</a><hr><section class=box><strong>Reply via email</strong><p>Thoughts, feedback, questions? I would like to hear about them! Just drop me an email at <a href=mailto:hello@confusedalex.dev> hello[at]confusedalex.dev</a></section><br><section class=box><h2>Webmentions</h2><div class=webmention><p>No webmentions yet. Be the first to comment, like or repost!</div></section><footer><hr><div id=footer-container></div><div><div class=retro-buttons-container><a href=https://512kb.club><img alt="a proud member of the green team of 512KB club" class=retro-button sizes=88x31 src=https://512kb.club/assets/images/green-team.gif></a><a href=https://neovim.io/><img alt="A button that indicated that this site was edited with VIM" class=retro-button sizes=88x31 src=/buttons/vim-button.gif></a><a href=https://transkidsdeservebetter.org/><img alt="A button that advocates for trans rights" class=retro-button sizes=88x31 src=/buttons/trans-rights-now.gif></a><a href=https://www.gnu.org/software/emacs/><img alt="A button that states, that this website was created with EMACS" class=retro-button sizes=88x31 src=/buttons/created-with-emacs.gif></a><a href=https://confusedalex.dev><img class=retro-button sizes=88x31 src=/buttons/confusedalex.gif></a></div></div></footer>